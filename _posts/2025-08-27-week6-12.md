---
layout: post
title: "Final Lap | GSoC 2025"
date: 2025-07-28
categories: [GSoC, KDE]
tags: [GSoC, KDE, Final]
---
<h2 style="color: #4285F4;">Final GSoC 2025 Update | Wrapping Up My GCompris Contribution </h2>


## TL;DR

- üìç **Before Week 6**: Built Editor for learn Decimals Activity and its sub activities which are Learn Decimal Addition and Subtraction

- üöÄ **Weeks 6‚Äì12**:  
  - Built editors for Graduated Line Read and Use , pending improvements. 
  - Restructured datasets to make them compatible with the editor.  
  - Added initial validation (range checks), pending valid targetnumber check.  
- ‚ö° **Challenges**: Hit roadblocks with `FieldEdit.qml` (string-only input). Solved by creating multiple input fields instead of reusing one.  
- üéØ **Learnings**: Start with a minimal working editor, iterate quickly, and get feedback early rather than overthinking one solution.  
- ‚è≠Ô∏è **Next Up**:  
  - Add a number-array input component.  
  - Implement  dataset validation inside the editor.  
  - work on next activities Share and Fractions create and use  

---


August is winding down, and so is my **GSoC 2025** journey with **KDE**. From setting the foundations during community bonding to overcoming mid-term challenges, these final weeks have been all about refining, polishing, and delivering meaningful improvements to the **GCompris** educational suite.

In this final blog, I‚Äôll walk you through the last leg of the sprint: the features I completed, deeper lessons I learned, the unexpected hurdles I navigated, and what‚Äôs next‚Äîboth for the project and for me :)


## What I Built

- **Dataset Restructure**: Created a cleaner dataset format to support both random and fixed question generation.  
- **Fixed Question Support**: Teachers can now set target numbers (e.g., "Find 13 on the ruler") instead of relying only on random questions.  
- **Validation & Fallbacks**: Added constraints to prevent invalid datasets and ensure smooth fallback behavior.  
- **Dynamic Titles**: Teachers can write custom titles for exercises.  
- **Graduated Lines read and Use Editor**: Built a basic dataset editor UI for  creation  of exercises for both the activities.  


## Let's talk about the core logic flow first 


[![](https://mermaid.ink/img/pako:eNqNVmlv2zgQ_SsEF8W2WCe1fMSJsFvAR5I2cU4nPSIHBS2NbLY6DJJK7ab570sOKVlJk8X6kznz5uCbg7qnYR4B9Wmc5D_CBROKXI2mGdG_V6_IRBnBuchDkNJK-4EV9kPF77ha35KtrXdkEPCMqzHcQXJrcZUPFJKhAKZ4nlnxAI2GQWik8KzZiClGrtZLIMMFhN8Jz0gNbWFDdDO6t4hIWxiDhyeeDvgKInLO1MKKRsbq15SWeJ_EBjGlv8h-gHkCmfBsngDZX4EIuQSX3D7GOwiGLAmLxOCy2QTmJBZ5SgTL5vBWKlg69AGiD4OYZ9EpMAFSExSrKybmoEicC6Lw72mRzkA4o0M0eh_0o2-FVA5BeEzyQpE8JrO8yCLpwO8R_CGYQIk8zyU3ND9l85Jlkc7xv0gQCDEsHAXjPF8StRB5MV8QcyVJmBBs7dweYdzjkqy0SBRfarrA0VXmd4y4satPrBuEp1xJV6CxS6GS-0SJAkwGJ8GUWmr_Iboxc_H6NdJ7wlZb9g_P3iDXb8hfxPt7Jt6-u5ZA4iJJbCGm9PbFKDFLJIY5rYWJuFwmbA3RpTEfQzZXC-3bsoIBNlVP2eosjiUolDtuJY7F0hWgil-VoOylahTIME81awos5AOSdeZm4rJIqp44sRp7OK0fKueDgicRQaPH43qG8PNgZgB1p-eouHgyO4TNGc-enyDrHSPp6bDKi5dn6VKTa2pSNoVmWECokjWSdpoTuSjiODGu6Avt-v8ibhp3okNO0GutF83wZAARRBh4AonOgoSFEJCpCvZMDhj8RG_Hp9vrEqm7CizpwuAQ5jxMrNoervBw_XiibM9JmKc6hXJYrhH5UV9h02hqwcPvmS4mmTGpS6Cb5o4lBeBNUDnRM4C7JGXfzEbRIona9qpmbQCg90Z1y48Y7JMO1l8utYaovHYRHz1gpK-NjZuvlfknNP-MiyfROw0ni-g6EMHnC3dUsFK3v3VSxhKizYqllX1GT1_Qk8yTwrB8KFiEzlgmf1QN-wWRN65hmXt-TL6uXW9cZ2S4T1uGCj3AVT_2-_q2x6DpckuVSRegNsX8J5jWkJqv3yb5ef-b7hsMdIAX3VQ7qhT8KW0tN3n8FsmEaNlwJsBwGBgHYdkeUcVY5fR5vrGV3fPdt2_mKKipyCFkIIxHZz8YOJR7Z4ePjrXPg3VSDabUB9DvSsyTxP9jsNfudTcfElZ55JSdkMXdZt1s7DSjVndUmlnNhdPs90btUbuuuSo1-KtrbpxmL2z1Zo_ijMr8YM-DnTZt0LngEfXNw9OgKYiUmSO9N0a6AAtI9Wrw9d8IYqbfuSmdZg_abMmymzxPS0uca-rjy9KgxVJvJxhxNhcsraR630QghvoBV9RvdZtN9EL9e7qifrfT3m73vGa71fM6u532boOuqb-10972ms2O1-zseJ1Wt7f70KA_Ma637Xmd9p7W7u16O57X3WlQiLjKcYT1FfC77uFfcyogyQ?type=png)](https://mermaid.live/edit#pako:eNqNVmlv2zgQ_SsEF8W2WCe1fMSJsFvAR5I2cU4nPSIHBS2NbLY6DJJK7ab570sOKVlJk8X6kznz5uCbg7qnYR4B9Wmc5D_CBROKXI2mGdG_V6_IRBnBuchDkNJK-4EV9kPF77ha35KtrXdkEPCMqzHcQXJrcZUPFJKhAKZ4nlnxAI2GQWik8KzZiClGrtZLIMMFhN8Jz0gNbWFDdDO6t4hIWxiDhyeeDvgKInLO1MKKRsbq15SWeJ_EBjGlv8h-gHkCmfBsngDZX4EIuQSX3D7GOwiGLAmLxOCy2QTmJBZ5SgTL5vBWKlg69AGiD4OYZ9EpMAFSExSrKybmoEicC6Lw72mRzkA4o0M0eh_0o2-FVA5BeEzyQpE8JrO8yCLpwO8R_CGYQIk8zyU3ND9l85Jlkc7xv0gQCDEsHAXjPF8StRB5MV8QcyVJmBBs7dweYdzjkqy0SBRfarrA0VXmd4y4satPrBuEp1xJV6CxS6GS-0SJAkwGJ8GUWmr_Iboxc_H6NdJ7wlZb9g_P3iDXb8hfxPt7Jt6-u5ZA4iJJbCGm9PbFKDFLJIY5rYWJuFwmbA3RpTEfQzZXC-3bsoIBNlVP2eosjiUolDtuJY7F0hWgil-VoOylahTIME81awos5AOSdeZm4rJIqp44sRp7OK0fKueDgicRQaPH43qG8PNgZgB1p-eouHgyO4TNGc-enyDrHSPp6bDKi5dn6VKTa2pSNoVmWECokjWSdpoTuSjiODGu6Avt-v8ibhp3okNO0GutF83wZAARRBh4AonOgoSFEJCpCvZMDhj8RG_Hp9vrEqm7CizpwuAQ5jxMrNoervBw_XiibM9JmKc6hXJYrhH5UV9h02hqwcPvmS4mmTGpS6Cb5o4lBeBNUDnRM4C7JGXfzEbRIona9qpmbQCg90Z1y48Y7JMO1l8utYaovHYRHz1gpK-NjZuvlfknNP-MiyfROw0ni-g6EMHnC3dUsFK3v3VSxhKizYqllX1GT1_Qk8yTwrB8KFiEzlgmf1QN-wWRN65hmXt-TL6uXW9cZ2S4T1uGCj3AVT_2-_q2x6DpckuVSRegNsX8J5jWkJqv3yb5ef-b7hsMdIAX3VQ7qhT8KW0tN3n8FsmEaNlwJsBwGBgHYdkeUcVY5fR5vrGV3fPdt2_mKKipyCFkIIxHZz8YOJR7Z4ePjrXPg3VSDabUB9DvSsyTxP9jsNfudTcfElZ55JSdkMXdZt1s7DSjVndUmlnNhdPs90btUbuuuSo1-KtrbpxmL2z1Zo_ijMr8YM-DnTZt0LngEfXNw9OgKYiUmSO9N0a6AAtI9Wrw9d8IYqbfuSmdZg_abMmymzxPS0uca-rjy9KgxVJvJxhxNhcsraR630QghvoBV9RvdZtN9EL9e7qifrfT3m73vGa71fM6u532boOuqb-10972ms2O1-zseJ1Wt7f70KA_Ma637Xmd9p7W7u16O57X3WlQiLjKcYT1FfC77uFfcyogyQ)


### Mode-Specific Behavior

The activity supports two interaction modes:

#### tick2number Mode
- **Question**: "What number is at this position?"
- **Behavior**: Cursor placed at target position, user types the answer

#### number2tick Mode  
- **Question**: "Where is number X?"
- **Behavior**: User navigates cursor to find the target number



## Code Changes Analysis

#### Before vs After Comparison


#### updated createLevel() Function:
```javascript
function createLevel() {
    exercices = [];
    if (levelRules.dataType === "fixed") {
        // Create single targeted exercise
        var exo = createExercice(0, levelRules, 0);
        exercices.push(exo);
        return;
    }else{
        for(var s = 0; s < levelRules.steps.length; s++) {
        for(var i = 0; i < nbTicks; i++) {
            // Generate all possible random exercises 
            //basically loop from i=0 to total possible ticks and use it 
        }
    }
    }

}
```
### create Exercise () 
```js
function createExercise(idx, rules, s) {
   ...
    // we need to handle logic differently for dataType =fixed
    if(rules.dataType==="fixed"){
        // for fixed datatype , fitlimits is always set to true
        nbSeg=Math.floor((rules.rangeMax-rules.rangeMin)/step)+1  // 0-3 , step 1  4  0-1-2-3
        var start =rules.rangeMin

        //get target number and adjust it if needed
        var originalTarget= rules.targetNumber
        var adjustedTarget= findNearestLeftTarget(originalTarget,start,step)

        //ensure adjusted target is within ruler bounds
        // that is adjusted target number > start  and lies between rangeMin and rangeMax

        var maxRulerValue=start+ ((nbSeg-1)*step)
        if(adjustedTarget>maxRulerValue){
            adjustedTarget=findNearestLeftTarget( maxRulerValue,start,step)
        }

        var targetPosition  =(adjustedTarget-start)/step     // 0 -10  step is 1 target:6  6-0/1 =6  index starts at 0->0
        if(targetPosition===0&& nbSeg>2){
            targetPosition=1 // skip start and end
            adjustedTarget=start +step  //move the target to second min if its < start

        } else if(targetPosition===nbSeg-1&& nbSeg>2){
            targetPosition=nbSeg-2
            adjustedTarget=start +((nbSeg-2)*step)  // move the targt to second max , if it exits ruler bounds
        }

        return {
            "solution":targetPosition,
            "step":step,
            "nbSeg":nbSeg,
            "start": start,
            "rangeMin": rules.rangeMin,
            "rangeMax": rules.rangeMax,
            "isFixed": true,
            "originalTarget": originalTarget,
            "adjustedTarget": adjustedTarget
        }
    }else if (rules.dataType==="random"){
        // when datatype is random i.e select random index as questions

        if (rules.fitLimits) {
            nbSeg = Math.floor((rules.rangeMax - rules.rangeMin) / step) + 1 //10-1 /3 =3+1 =4
        } else {
            nbSeg = 1 + rules.displayedRangeLengthMin + randInt(1 + rules.displayedRangeLengthMax - rules.displayedRangeLengthMin)
            maxOffset = rules.rangeMax - (nbSeg * step)
            while (maxOffset < 0) {             // if data is not valid, reduce the number of segment
                nbSeg--
                maxOffset =  rules.rangeMax - (nbSeg * step)
            }
            maxOffset = rules.rangeMax - ((nbSeg - 1) * step)
        }
        ...
        return {
            "solution": idx,
            "step": step,
            "nbSeg": nbSeg,
            "start": start,
            "rangeMin": rules.rangeMin,
            "rangeMax": rules.rangeMax
        }
    }
}
```

Implemented `findNearestLeftTarget()` to handle misaligned targets:
```javascript
function findNearestLeftTarget(targetNumber, rangeMin, step) {
    var stepsFromMin = Math.floor((targetNumber - rangeMin) / step);
    return rangeMin + (stepsFromMin * step);
}
```


The above check for adjustment of target number will not be needed once in future this check is implemented at the editor end , that is user would not be able to create invalid dataset 

 the above createExercise() function generates exercises following way
 ```js
exercices = [
    
    {solution: 1, step: 2, nbSeg: 11, start: 0},  // asks for position 1 (value=2)
    {solution: 2, step: 2, nbSeg: 11, start: 0},  
    {solution: 3, step: 2, nbSeg: 11, start: 0},  
  
   //another case 
    {solution: 1, step: 5, nbSeg: 5, start: 0},   
    {solution: 2, step: 5, nbSeg: 5, start: 0},   //asks for position 2 value 0 + 5*2 =10
    {solution: 3, step: 5, nbSeg: 5, start: 0},   
]

```
### Variable Tracking: The `start` Variable

Understanding the `start` variable behavior across different configurations:

| Case | fitLimits | start Value | Behavior |
|------|-----------|-------------|----------|
| Random + true | true | Always rangeMin | Full range ruler |
| Random + false | false | Random within range | Sliding window ruler |
| Fixed | true (always) | Always rangeMin | Full range ruler |

**Key Insight**: When `fitLimits = false`, `start` is calculated as:
```javascript
maxOffset = rangeMax - (nbSeg  * step);
start = rangeMin + randInt(maxOffset);
```
This ensures the ruler segment never exceeds `rangeMax`.



| Aspect            | Random (fitLimits=true)                  | Random (fitLimits=false)                 | Fixed                          |
|-------------------|------------------------------------------|------------------------------------------|--------------------------------|
| Exercise Count    | Multiple (based on steps √ó ticks)        | Multiple (same calculation)               | Single                         |
| Ruler Structure   | Always spans full range                  | Variable size & position                  | Always spans full range         |
| Target Selection  | Random from all positions                | Random from all positions                 | Specific target number          |
| Shuffling         | Yes, exercises shuffled                  | Yes, exercises shuffled                   | No shuffling                    |
| Solution Field    | Position index                           | Position index                            | Position index of target        |
| Answer Field      | Ruler value at solution                  | Ruler value at solution                   | Adjusted target value           |




### Test Scenarios Implemented

1. **Valid Fixed Target**: `rangeMin: 0, rangeMax: 20, step: 2, targetNumber: 8`
   - Expected: `adjustedTarget: 8, targetPosition: 4`

2. **Target Adjustment**: `rangeMin: 0, rangeMax: 20, step: 2, targetNumber: 13`
   - Expected: `adjustedTarget: 12, targetPosition: 6`

3. **Out-of-Bounds Target**: `rangeMin: 50, rangeMax: 100, step: 5, targetNumber: 30`
   - Expected: `adjustedTarget: 55, targetPosition: 1` 
   ### the above functionality would be improved further by not allowing invalid datasets to be passed by editor 


<h2 style="color: #EA4335;">Restructured the Dataset for both Graduated line read and use </h2>

#### Basic Fixed Question:
```javascript
{
    "title": "Find the requested number",
    "rules": [{
        "dataType": "fixed",
        "nbOfQuestions": 1,
        "fitLimits": true,
        "rangeMin": 0,
        "rangeMax": 20,
        "steps": [2],
        "targetNumber": 13
        "displayedRangeLengthMin" :0
        "displayedRangeLengthMax" :0
    }]
}
```
rangeMin / rangeMax ‚Üí define the limits of the ruler.

steps ‚Üí the interval between values (e.g., step size = 2).

targetNumber ‚Üí the number the learner is asked to find.

fitLimits ‚Üí when set to true, the ruler uses the exact min and max values given.

displayedRangeLengthMin / Max ‚Üí not relevant in this fixed dataset, so both are set to 0.

Example question generated: ‚ÄúFind the requested number between 0 and 20 with step size = 2.‚Äù

In random mode, there are two cases:

fitLimits = true ‚Üí the activity randomly chooses a target number within the fixed range (0‚Äì20).

fitLimits = false ‚Üí the activity randomly selects a segment between displayedRangeLengthMin and displayedRangeLengthMax, then picks a random number inside that segment.

#### when Dataset is of type Random:
```javascript
{
    "title": "Find numbers 0-20",
    "rules": [{
        "dataType": "random",
        "nbOfQuestions": 5,
        "fitLimits": true,
        "rangeMin": 0,
        "rangeMax": 20,
        "steps": [1]
    }]
}
```
In  case of random there are two modes one where fitlimits is true and one where its false 
in case of fitlimits set to true activity randomly chooses an index to ask , while keeping the range fixed , in other case activity picks up a segment in between displayedRangeLength min and max and piks up random index from that segment and creates a question.
 Ensured cursor randomization works correctly in both modes:
```javascript
if (activityMode === "number2tick") {
        if (exo.isFixed) {
            // fixed data: randomize cursor, but keep target as answer
            items.solutionGrad = randInt(exo.nbSeg - 2) + 1
            items.answer = exo.adjustedTarget.toString()  // Always the fixed target
        } else {
            // random data: randomize cursor and use that position's value
            items.solutionGrad = randInt(exo.nbSeg - 2) + 1
            items.answer = items.rulerModel.get(items.solutionGrad).value_.toString()
        }
    }
```
<h2 style="color:rgb(49, 194, 27);">What's Achieved So Far</h2>

## Working Editor for Both Graduated Line Read & Use Activities

A working editor now exists for both **Graduated Line Read** and **Graduated Line Use** activities.  
However, major improvements are still pending‚Äîfor example, the editor currently does not validate datasets.  

Right now, it only checks that `rangeMin < rangeMax`.  
In the future, I plan to add a text warning for teachers when an invalid dataset is created.  

![AdditionsEditor](/resources/finalWeek/editor.png){: width="400" height="300"}

### Added a popup dialog to provide instrucutions .

![AdditionsEditor](/resources/finalWeek/title.png){: width="400" height="300"}

### Logs for tracking the flow of activity to ease things.

```
qml: Range Min changed: rangeMin = 1 at index 0
qml: range Min cannot be greater than or equal to Range Max
qml: Range Max changed: rangeMax = 1 at index 0
qml: range Max cannot be less than or equal to Range Min
qml: text from the dialog is accepted: Number to find between 10 and 20
```
## graduated line read 
![AdditionsEditor](/resources/finalWeek/read.png){: width="400" height="300"}


## graduated line use
![AdditionsEditor](/resources/finalWeek/use.png){: width="400" height="300"}



## Future Work Post GSoC

<h4 style="color:rgb(194, 27, 188);">Future Tasks</h4>

1. **Build a number-array input component**  
   Most of the difficulty came from the limitation in `FieldEdit.qml`, which converts everything to strings.  
   Currently, it‚Äôs not possible to have the same field component represent different input types, so I‚Äôll work on creating a dedicated component for number arrays.  

2. **Add dataset validation for target numbers in the Graduated Line editor**  
   Right now, only a basic `rangeMin < rangeMax` check exists. I plan to add a proper validation step for target numbers inside the editor.  

3. **Work on the next set of activities**  
   - Fractions: Create & Use  
   - Share  
## Difficulties Faced  

Most of my time went into resolving issues. One major challenge was with **FieldEdit** ‚Äî  
initially, I tried to reuse the same field for multiple input types, but that approach didn‚Äôt work.  
In the end, we dropped the idea and created multiple fields instead.  

For example, while working on the **Graduated Line** activity, we started with the following default dataset:  

```json
{
    "title": "Find the requested number",
    "rules": [{
        "nbOfQuestions": 1,
        "fitLimits": true,
        "range": [0, 10],
        "steps": [2, 5],
        "displayedRangeLengthMin": 0,
        "displayedRangeLengthMax": 0
    }]
}
```

In cases where the dataset type is fixed, the steps field should accept only one value.
But for random, it needs to accept multiple values.

Since FieldEdit does not allow the same field to handle both an array and a single integer,
we chose the approach of creating two separate fields:

    stepFixed (for fixed datasets)

    steps (for random datasets)

Another difficulty was handling the **legacy dataset**. At first, I thought I needed to find a way to make it work,  
but I soon realized that restructuring the dataset was necessary for the editor to function properly because the server was appending the dataset a certain format , and it was probably easier to restructure the default dataset.

With the experience I‚Äôve gained from working on GCompris, if I were starting over,  
I‚Äôd first focus on getting a **basic working editor** and then add functionalities later.  
A key lesson for me is to try out different ideas earlier and seek feedback,  
rather than spending too much time stuck on one solution.  
If I had done this sooner, I would have learned more and saved time ‚Äî something I‚Äôll remember for the future üôÇ.  



<h1 style="color:rgb(194, 27, 188);">overall Impact  </h1>

## Overall Impact  

I worked on adding editor support for several activities that previously lacked it, including:  
- **Learn Decimals**  
- **Quantity**  
- **Learn Decimals: Addition & Subtraction**  
- **Graduated Line Read & Use**  

With these editors in place:  
- üë©‚Äçüè´ Teachers can now **create and customize exercises** for these activities.   
- üõ†Ô∏è The editors provide basic validation, reducing the chance of invalid datasets.  

This makes the activities much more **flexible and adaptable for classroom use**,  
 

<h1 style="color:rgb(194, 27, 188);">Conclusion</h1>

In conclusion, two activities ‚Äî **Share** and **Grammar Analysis** ‚Äî were dropped after the midterm due to time constraints.  

Out of the five initially planned activities, the following have been successfully completed:  
- Editor for **Learn Decimals** and its related activities  
- **Learn Quantity**  
- **Learn Decimal Addition and Subtraction**  
- A basic editor for **Graduated Line Read & Use** (with dataset validation still pending)  

---

In terms of experience, I gained substantial knowledge while working on this project.  
I became comfortable with **Git**, and more importantly, I learned how to navigate and contribute to a large-scale codebase.  
I particularly appreciated how modular the GCompris codebase is ‚Äî each function is designed to perform a single, well-defined task without overlapping responsibilities. (As a rule of thumb, if a function is more than 10 lines long, it can usually be optimized further üôÇ.)  

Although I did not directly work with the networking and database components, my involvement in developing and understanding the activities gave me valuable insights into how different systems integrate and function together.  

This experience not only strengthened my technical skills but also played a significant role in helping me secure a position at a **major product-based company**.  

Looking ahead, I have the next couple of months to myself, and I commit to completing the pending backlog.  
