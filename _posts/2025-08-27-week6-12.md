---
layout: post
title: "Final Lap | GSoC 2025"
date: 2025-07-26
categories: [GSoC, KDE]
tags: [GSoC, KDE, Final]
---
<h2 style="color: #4285F4;">Final GSoC 2025 Update | Wrapping Up My GCompris Contribution </h2>

August is winding down, and so is my **GSoC 2025** journey with **KDE**. From setting the foundations during community bonding to overcoming mid-term challenges, these final weeks have been all about refining, polishing, and delivering meaningful improvements to the **GCompris** educational suite.

In this final blog, I’ll walk you through the last leg of the sprint: the features I completed, deeper lessons I learned, the unexpected hurdles I navigated, and what’s next—both for the project and for me :)


## What I Built

- **Dataset Restructure**: Created a cleaner dataset format to support both random and fixed question generation.  
- **Fixed Question Support**: Teachers can now set target numbers (e.g., "Find 13 on the ruler") instead of relying only on random questions.  
- **Validation & Fallbacks**: Added constraints to prevent invalid datasets and ensure smooth fallback behavior.  
- **Dynamic Titles**: Teachers can write custom titles for exercises.  
- **Graduated Lines read and Use Editor**: Built a basic dataset editor UI for  creation  of exercises for both the activities.  


## Let's talk about the core logic flow first 


[![](https://mermaid.ink/img/pako:eNqNVmlv2zgQ_SsEF8W2WCe1fMSJsFvAR5I2cU4nPSIHBS2NbLY6DJJK7ab570sOKVlJk8X6kznz5uCbg7qnYR4B9Wmc5D_CBROKXI2mGdG_V6_IRBnBuchDkNJK-4EV9kPF77ha35KtrXdkEPCMqzHcQXJrcZUPFJKhAKZ4nlnxAI2GQWik8KzZiClGrtZLIMMFhN8Jz0gNbWFDdDO6t4hIWxiDhyeeDvgKInLO1MKKRsbq15SWeJ_EBjGlv8h-gHkCmfBsngDZX4EIuQSX3D7GOwiGLAmLxOCy2QTmJBZ5SgTL5vBWKlg69AGiD4OYZ9EpMAFSExSrKybmoEicC6Lw72mRzkA4o0M0eh_0o2-FVA5BeEzyQpE8JrO8yCLpwO8R_CGYQIk8zyU3ND9l85Jlkc7xv0gQCDEsHAXjPF8StRB5MV8QcyVJmBBs7dweYdzjkqy0SBRfarrA0VXmd4y4satPrBuEp1xJV6CxS6GS-0SJAkwGJ8GUWmr_Iboxc_H6NdJ7wlZb9g_P3iDXb8hfxPt7Jt6-u5ZA4iJJbCGm9PbFKDFLJIY5rYWJuFwmbA3RpTEfQzZXC-3bsoIBNlVP2eosjiUolDtuJY7F0hWgil-VoOylahTIME81awos5AOSdeZm4rJIqp44sRp7OK0fKueDgicRQaPH43qG8PNgZgB1p-eouHgyO4TNGc-enyDrHSPp6bDKi5dn6VKTa2pSNoVmWECokjWSdpoTuSjiODGu6Avt-v8ibhp3okNO0GutF83wZAARRBh4AonOgoSFEJCpCvZMDhj8RG_Hp9vrEqm7CizpwuAQ5jxMrNoervBw_XiibM9JmKc6hXJYrhH5UV9h02hqwcPvmS4mmTGpS6Cb5o4lBeBNUDnRM4C7JGXfzEbRIona9qpmbQCg90Z1y48Y7JMO1l8utYaovHYRHz1gpK-NjZuvlfknNP-MiyfROw0ni-g6EMHnC3dUsFK3v3VSxhKizYqllX1GT1_Qk8yTwrB8KFiEzlgmf1QN-wWRN65hmXt-TL6uXW9cZ2S4T1uGCj3AVT_2-_q2x6DpckuVSRegNsX8J5jWkJqv3yb5ef-b7hsMdIAX3VQ7qhT8KW0tN3n8FsmEaNlwJsBwGBgHYdkeUcVY5fR5vrGV3fPdt2_mKKipyCFkIIxHZz8YOJR7Z4ePjrXPg3VSDabUB9DvSsyTxP9jsNfudTcfElZ55JSdkMXdZt1s7DSjVndUmlnNhdPs90btUbuuuSo1-KtrbpxmL2z1Zo_ijMr8YM-DnTZt0LngEfXNw9OgKYiUmSO9N0a6AAtI9Wrw9d8IYqbfuSmdZg_abMmymzxPS0uca-rjy9KgxVJvJxhxNhcsraR630QghvoBV9RvdZtN9EL9e7qifrfT3m73vGa71fM6u532boOuqb-10972ms2O1-zseJ1Wt7f70KA_Ma637Xmd9p7W7u16O57X3WlQiLjKcYT1FfC77uFfcyogyQ?type=png)](https://mermaid.live/edit#pako:eNqNVmlv2zgQ_SsEF8W2WCe1fMSJsFvAR5I2cU4nPSIHBS2NbLY6DJJK7ab570sOKVlJk8X6kznz5uCbg7qnYR4B9Wmc5D_CBROKXI2mGdG_V6_IRBnBuchDkNJK-4EV9kPF77ha35KtrXdkEPCMqzHcQXJrcZUPFJKhAKZ4nlnxAI2GQWik8KzZiClGrtZLIMMFhN8Jz0gNbWFDdDO6t4hIWxiDhyeeDvgKInLO1MKKRsbq15SWeJ_EBjGlv8h-gHkCmfBsngDZX4EIuQSX3D7GOwiGLAmLxOCy2QTmJBZ5SgTL5vBWKlg69AGiD4OYZ9EpMAFSExSrKybmoEicC6Lw72mRzkA4o0M0eh_0o2-FVA5BeEzyQpE8JrO8yCLpwO8R_CGYQIk8zyU3ND9l85Jlkc7xv0gQCDEsHAXjPF8StRB5MV8QcyVJmBBs7dweYdzjkqy0SBRfarrA0VXmd4y4satPrBuEp1xJV6CxS6GS-0SJAkwGJ8GUWmr_Iboxc_H6NdJ7wlZb9g_P3iDXb8hfxPt7Jt6-u5ZA4iJJbCGm9PbFKDFLJIY5rYWJuFwmbA3RpTEfQzZXC-3bsoIBNlVP2eosjiUolDtuJY7F0hWgil-VoOylahTIME81awos5AOSdeZm4rJIqp44sRp7OK0fKueDgicRQaPH43qG8PNgZgB1p-eouHgyO4TNGc-enyDrHSPp6bDKi5dn6VKTa2pSNoVmWECokjWSdpoTuSjiODGu6Avt-v8ibhp3okNO0GutF83wZAARRBh4AonOgoSFEJCpCvZMDhj8RG_Hp9vrEqm7CizpwuAQ5jxMrNoervBw_XiibM9JmKc6hXJYrhH5UV9h02hqwcPvmS4mmTGpS6Cb5o4lBeBNUDnRM4C7JGXfzEbRIona9qpmbQCg90Z1y48Y7JMO1l8utYaovHYRHz1gpK-NjZuvlfknNP-MiyfROw0ni-g6EMHnC3dUsFK3v3VSxhKizYqllX1GT1_Qk8yTwrB8KFiEzlgmf1QN-wWRN65hmXt-TL6uXW9cZ2S4T1uGCj3AVT_2-_q2x6DpckuVSRegNsX8J5jWkJqv3yb5ef-b7hsMdIAX3VQ7qhT8KW0tN3n8FsmEaNlwJsBwGBgHYdkeUcVY5fR5vrGV3fPdt2_mKKipyCFkIIxHZz8YOJR7Z4ePjrXPg3VSDabUB9DvSsyTxP9jsNfudTcfElZ55JSdkMXdZt1s7DSjVndUmlnNhdPs90btUbuuuSo1-KtrbpxmL2z1Zo_ijMr8YM-DnTZt0LngEfXNw9OgKYiUmSO9N0a6AAtI9Wrw9d8IYqbfuSmdZg_abMmymzxPS0uca-rjy9KgxVJvJxhxNhcsraR630QghvoBV9RvdZtN9EL9e7qifrfT3m73vGa71fM6u532boOuqb-10972ms2O1-zseJ1Wt7f70KA_Ma637Xmd9p7W7u16O57X3WlQiLjKcYT1FfC77uFfcyogyQ)


### Mode-Specific Behavior

The activity supports two interaction modes:

#### tick2number Mode
- **Question**: "What number is at this position?"
- **Behavior**: Cursor placed at target position, user types the answer

#### number2tick Mode  
- **Question**: "Where is number X?"
- **Behavior**: User navigates cursor to find the target number



## Code Changes Analysis

#### Before vs After Comparison


#### updated createLevel() Function:
```javascript
function createLevel() {
    exercices = [];
    if (levelRules.dataType === "fixed") {
        // Create single targeted exercise
        var exo = createExercice(0, levelRules, 0);
        exercices.push(exo);
        return;
    }else{
        for(var s = 0; s < levelRules.steps.length; s++) {
        for(var i = 0; i < nbTicks; i++) {
            // Generate all possible random exercises 
            //basically loop from i=0 to total possible ticks and use it 
        }
    }
    }

}
```
### create Exercise () 
```js
function createExercise(idx, rules, s) {
   ...
    // we need to handle logic differently for dataType =fixed
    if(rules.dataType==="fixed"){
        // for fixed datatype , fitlimits is always set to true
        nbSeg=Math.floor((rules.rangeMax-rules.rangeMin)/step)+1  // 0-3 , step 1  4  0-1-2-3
        var start =rules.rangeMin

        //get target number and adjust it if needed
        var originalTarget= rules.targetNumber
        var adjustedTarget= findNearestLeftTarget(originalTarget,start,step)

        //ensure adjusted target is within ruler bounds
        // that is adjusted target number > start  and lies between rangeMin and rangeMax

        var maxRulerValue=start+ ((nbSeg-1)*step)
        if(adjustedTarget>maxRulerValue){
            adjustedTarget=findNearestLeftTarget( maxRulerValue,start,step)
        }

        var targetPosition  =(adjustedTarget-start)/step     // 0 -10  step is 1 target:6  6-0/1 =6  index starts at 0->0
        if(targetPosition===0&& nbSeg>2){
            targetPosition=1 // skip start and end
            adjustedTarget=start +step  //move the target to second min if its < start

        } else if(targetPosition===nbSeg-1&& nbSeg>2){
            targetPosition=nbSeg-2
            adjustedTarget=start +((nbSeg-2)*step)  // move the targt to second max , if it exits ruler bounds
        }

        return {
            "solution":targetPosition,
            "step":step,
            "nbSeg":nbSeg,
            "start": start,
            "rangeMin": rules.rangeMin,
            "rangeMax": rules.rangeMax,
            "isFixed": true,
            "originalTarget": originalTarget,
            "adjustedTarget": adjustedTarget
        }
    }else if (rules.dataType==="random"){
        // when datatype is random i.e select random index as questions

        if (rules.fitLimits) {
            nbSeg = Math.floor((rules.rangeMax - rules.rangeMin) / step) + 1 //10-1 /3 =3+1 =4
        } else {
            nbSeg = 1 + rules.displayedRangeLengthMin + randInt(1 + rules.displayedRangeLengthMax - rules.displayedRangeLengthMin)
            maxOffset = rules.rangeMax - (nbSeg * step)
            while (maxOffset < 0) {             // if data is not valid, reduce the number of segment
                nbSeg--
                maxOffset =  rules.rangeMax - (nbSeg * step)
            }
            maxOffset = rules.rangeMax - ((nbSeg - 1) * step)
        }
        ...
        return {
            "solution": idx,
            "step": step,
            "nbSeg": nbSeg,
            "start": start,
            "rangeMin": rules.rangeMin,
            "rangeMax": rules.rangeMax
        }
    }
}
```

Implemented `findNearestLeftTarget()` to handle misaligned targets:
```javascript
function findNearestLeftTarget(targetNumber, rangeMin, step) {
    var stepsFromMin = Math.floor((targetNumber - rangeMin) / step);
    return rangeMin + (stepsFromMin * step);
}
```


The above check for adjustment of target number will not be needed once in future this check is implemented at the editor end , that is user would not be able to create invalid dataset 

 the above createExercise() function generates exercises following way
 ```js
exercices = [
    
    {solution: 1, step: 2, nbSeg: 11, start: 0},  // asks for position 1 (value=2)
    {solution: 2, step: 2, nbSeg: 11, start: 0},  
    {solution: 3, step: 2, nbSeg: 11, start: 0},  
  
   //another case 
    {solution: 1, step: 5, nbSeg: 5, start: 0},   
    {solution: 2, step: 5, nbSeg: 5, start: 0},   //asks for position 2 value 0 + 5*2 =10
    {solution: 3, step: 5, nbSeg: 5, start: 0},   
]

```
### Variable Tracking: The `start` Variable

Understanding the `start` variable behavior across different configurations:

| Case | fitLimits | start Value | Behavior |
|------|-----------|-------------|----------|
| Random + true | true | Always rangeMin | Full range ruler |
| Random + false | false | Random within range | Sliding window ruler |
| Fixed | true (always) | Always rangeMin | Full range ruler |

**Key Insight**: When `fitLimits = false`, `start` is calculated as:
```javascript
maxOffset = rangeMax - (nbSeg  * step);
start = rangeMin + randInt(maxOffset);
```
This ensures the ruler segment never exceeds `rangeMax`.



| Aspect            | Random (fitLimits=true)                  | Random (fitLimits=false)                 | Fixed                          |
|-------------------|------------------------------------------|------------------------------------------|--------------------------------|
| Exercise Count    | Multiple (based on steps × ticks)        | Multiple (same calculation)               | Single                         |
| Ruler Structure   | Always spans full range                  | Variable size & position                  | Always spans full range         |
| Target Selection  | Random from all positions                | Random from all positions                 | Specific target number          |
| Shuffling         | Yes, exercises shuffled                  | Yes, exercises shuffled                   | No shuffling                    |
| Solution Field    | Position index                           | Position index                            | Position index of target        |
| Answer Field      | Ruler value at solution                  | Ruler value at solution                   | Adjusted target value           |




### Test Scenarios Implemented

1. **Valid Fixed Target**: `rangeMin: 0, rangeMax: 20, step: 2, targetNumber: 8`
   - Expected: `adjustedTarget: 8, targetPosition: 4`

2. **Target Adjustment**: `rangeMin: 0, rangeMax: 20, step: 2, targetNumber: 13`
   - Expected: `adjustedTarget: 12, targetPosition: 6`

3. **Out-of-Bounds Target**: `rangeMin: 50, rangeMax: 100, step: 5, targetNumber: 30`
   - Expected: `adjustedTarget: 55, targetPosition: 1` 
   ### the above functionality would be improved further by not allowing invalid datasets to be passed by editor 


<h2 style="color: #EA4335;">Restructured the Dataset for both Graduated line read and use </h2>

#### Basic Fixed Question:
```javascript
{
    "title": "Find the requested number",
    "rules": [{
        "dataType": "fixed",
        "nbOfQuestions": 1,
        "fitLimits": true,
        "rangeMin": 0,
        "rangeMax": 20,
        "steps": [2],
        "targetNumber": 13
        "displayedRangeLengthMin" :0
        "displayedRangeLengthMax" :0
    }]
}
```

#### when Dataset is of type Random:
```javascript
{
    "title": "Find numbers 0-20",
    "rules": [{
        "dataType": "random",
        "nbOfQuestions": 5,
        "fitLimits": true,
        "rangeMin": 0,
        "rangeMax": 20,
        "steps": [1]
    }]
}
```
 Ensured cursor randomization works correctly in both modes:
```javascript
if (activityMode === "number2tick") {
        if (exo.isFixed) {
            // fixed data: randomize cursor, but keep target as answer
            items.solutionGrad = randInt(exo.nbSeg - 2) + 1
            items.answer = exo.adjustedTarget.toString()  // Always the fixed target
        } else {
            // random data: randomize cursor and use that position's value
            items.solutionGrad = randInt(exo.nbSeg - 2) + 1
            items.answer = items.rulerModel.get(items.solutionGrad).value_.toString()
        }
    }
```
<h2 style="color:rgb(49, 194, 27);">What's achieved so far </h2>

##Working editor for both graduated line read and use acitvity. , however major changes are pending such as the editor does not have a valid dataset check for now 
For now it has a basic range min < range max check ,
In future I will try to add a text warning for the teacher stating not a valid dataset

![AdditionsEditor](/resources/finalWeek/editor.png){: width="400" height="300"}

##Added a popup dialog to provide instrucutions .

![AdditionsEditor](/resources/finalWeek/title.png){: width="400" height="300"}

Logs for tracking the flow of activity to ease things.

```
qml: Range Min changed: rangeMin = 1 at index 0
qml: range Min cannot be greater than or equal to Range Max
qml: Range Max changed: rangeMax = 1 at index 0
qml: range Max cannot be less than or equal to Range Min
qml: text from the dialog is accepted: Number to find between 10 and 20
```
## graduated line read 
![AdditionsEditor](/resources/finalWeek/read.png){: width="400" height="300"}


## graduated line use
![AdditionsEditor](/resources/finalWeek/use.png){: width="400" height="300"}



## Future Work Post Gsoc 


<h4 style="color:rgb(194, 27, 188);">Future tasks </h4> 


1. build a component that allows number arrays as input , most of the difficulty coming was because of limitation in the FieldEdit.qml since it converts everything to string, also its currenlty not possible to have the same field component represents different input types. 

2. Add the valid dataset check for target numbers Graduated line editor . 

3. work on completing the  following next activities.

    1.Fractions create and use 

    2.Share 

## Difficulties faced 
 Most of my time went on figuring out resolving issues such as ,  the issue with field edit  we later dropped the idea and went with creating multiple field rather than using same field for different input types . Earlier I felt the need to figure out a way to work with leagcy dataset but realized it soon that we need to restructure the dataset to be able to work with the editor . 
 With the expeirienced I gained by working on gcompris if I have to start I would probably first focus on getting a basic working editor , and adding functionalities later on ,lesson from here is I would probably invest now more time on trying out different ideas , rather than thinking about one solution , I feel like if I had tried stuff and then get feedback on it It would have taken less time and more learning , something Ill remember for future  : )



<h1 style="color:rgb(194, 27, 188);">Conclusion  </h1>

In conclusion, two activities — Share and Grammar Analysis — were dropped post mid-term due to time constraints.

Out of the initial five planned activities, the following have been successfully completed:

Editor for "Learn Decimals" and related activities

Learn Quantity

Learn Decimal Addition and Subtraction

A basic editor for "Graduated Line Read and Use"

Pending dataset validation check

In terms of experience, I gained substantial knowledge while working on this project. I became comfortable with Git, and more importantly, I learned how to navigate and contribute to a large-scale codebase. I particularly appreciated how the GCompris codebase is highly modular — each function is designed to perform a single, well-defined task without overlapping responsibilities.
If a function has more than 10 lines to it , it could be optimized further : ).

Although I did not directly work with the networking and database components, my involvement in developing and understanding the activities gave me valuable insights into how these systems integrate and function together. This experience not only strengthened my technical skills but also played a significant role in helping me secure a position at a major product-based company.
I have next couple of months to myself and I commit on completing the pending backlog that I have.